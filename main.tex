\documentclass[12pt]{amsart}

\title{Mathematical Finance in discrete time}
\author{Elias Mindlberger}
\date{Winter Semester 2025/26}

\input{macros}
\input{style}

\begin{document}

\maketitle

\tableofcontents
\bigskip

\section{Introduction and first example}

We start by introducing the first important notions of option pricing and first examples.

\subsection{Notions for option pricing theory}

An \textbf{option} is a contract beween two parties (a buyer and a seller). The buyer pays an option price \emph{today} (i.e.\ at \(t=0\)) to the seller and in return obtains the right/\emph{option} \underline{but not the obligation} to buy a stock for conditions that are fixed \emph{today} at a fixed point in time (\emph{the maturity of the option}).
The option to buy is thereby crucial: the buyer can just refrain from buying the stock if te market conditions are disadvantageous.

We only consider options whose \emph{underlyings (german: Basistitel)} are stocks.\newpage

We distinguish the following:

\begin{tikzpicture}[>=stealth, thick]
    % Arrows for call and put
    \draw[->] (-3,0) -- (3,2);
    \draw[->] (-3,0) -- (3,-2);

    % Labels
    \node at (4.5,2) {\textbf{Call option}};
    \node at (4.5,-2) {\textbf{Put option}};

    % Text below arrows
    \node[align=left] at (6,1) {Buyer has the right to \underline{buy} \\ the stock for the \emph{strike price} \(K\).};
    \node[align=left] at (6,-3) {Buyer has the right to \underline{sell} \\ the stock for the \emph{strike price} \(K\).};

    % Arrows for call and put
    \draw[->] (-3,-7) -- (3,-5);
    \draw[->] (-3,-7) -- (3,-9);

    % Labels
    \node at (5,-5) {\textbf{European option}};
    \node at (5,-9) {\textbf{American option}};

    % Text below arrows
    \node[align=left] at (6.5,-5.7) {Can only be exercised at maturity \(T\).};
    \node[align=left] at (6.5,-9.7) {Can be exercised at \(t\) s.t.\ \(0 \leq t \leq T\).};
\end{tikzpicture}

We call the above \textbf{standard} or \textbf{vanilla} options. Other options are called \textbf{exotic}. Such include \emph{Asian options} (which operate on the mean--value of an asset), \emph{barrier options}, \emph{options on voatility} and so forth. For this course we assume that options have a price at any point in time \(0 \leq t \leq T\). Advantages of options include
\begin{itemize}
    \item The loss is limited: worst case is the loss of the option price,
    \item leverage effect (in a positive market development),
    \item can be used to \emph{hedge} against decreasing stock prices via put options (can be sold for a fixed pre--determined price).
\end{itemize}

\subsection{A first example}

Let us consider a call option in a two--period market model. We set
\begin{itemize}
    \item \(t=0\): the current time or today,
    \item \(T>0\): the maturity or exercise date of the option,
    \item \(S_T\): random price of the underlying stock at time \(T\),
    \item \(S_0\): known price of the underlying stock at time \(t=0\),
    \item \(K\): the strike price.
\end{itemize}

\begin{remark}
    No physical transaction of the stock at time \(T\) happens. Only the profit is paid out accordingly.
\end{remark}
Clearly, the \textbf{payoff} for a call option at time \(T\) is \[
    H = \max \set{S_T-K, 0} = \left(S_T-K\right)^+.
\]
\(H\) itself is a random variable since \(S_T\) is assumed to be random.


\begin{center}
    \begin{tikzpicture}
        \begin{axis}[
            axis lines=middle,
            samples=200,
            domain=-1:4,
            ymin=-0.5, ymax=3,
            xmin=-1, xmax=4,
            axis line style={->, thick},
            xtick=\empty,
            ytick=\empty,
            xlabel={\(S_T\)},
            ylabel={Payoff},
            width=8cm,
            height=6cm
        ]

        % Dashed part for x < K
        \addplot[blue, ultra thick, dashed, domain=-1:1.5] {0};

        % Solid part for x >= K
        \addplot[blue, ultra thick, domain=1.5:4] {x-1.5};

        % Mark K
        \draw[dashed, gray] (axis cs:1.5,0) -- (axis cs:1.5,1.5);
        \filldraw[black] (axis cs:1.5,0) circle (1.5pt) node[below] {\(K\)};

        % Function label
        \node[blue, above right] at (axis cs:3,1) {\(H\)};

        \end{axis}
    \end{tikzpicture}

    \vspace{0.5em}
    \small\textbf{Figure:} Visualisation of the payoff \(H\) dependent on the strike \(K\).
\end{center}

Take \(S_0=100\) and assume the stock can attain two prices at \(T\). Either it attains \(150\) in the case of \(\omega_1\) or it attains \(90\) in the case of \(\omega_2\), i.e.\ \(S_T(\omega_1) = 150\) and \(S_T(\omega_2) = 90\) with probabilities \(p\) and \(1-p\) respectively. We let \(130\) be the strike \(K\). The payoff is obviously \(20\) and \(0\) respectively. We assume that there is an additional, riskless investment opportunity with interest rate \(r=0\).

\textbf{Question.} What is the fair price \(\pi(H)\) of the above option at \(t=0\)?

\textbf{Idea: No--arbitrage--principle.}
There is no arbitrage (i.e.\ no riskless profit) in the financial market.

The payoff \(H\) is replicated by other assets (in this case stocks and riskless investments).

The initial capital that is needed in order to replicate \(H\) corresponds to the price of the option. Otherwise, there is arbitrage.

We now want to find a \textbf{trading strategy} \((\alpha, \beta) \in \R^2\) with
\begin{itemize}
    \item \(\alpha\), the number of stocks that we buy at \(t=0\),
    \item \(\beta\), the investment in the riskless asset (RA).
\end{itemize}

The value of the portfolio at \(t=0\) is \(V_0(\alpha, \beta) = \beta \cdot 1 + \alpha S_0\) (the RA is normalised) and the value of the portfolio at \(t=T\) is \(V_T(\alpha, \beta) = \beta \cdot 1 + \alpha S_T\) (recall \(r=0\)). We want to \emph{hedge} or \emph{replicate} the payoff, i.e.\ choose \((\alpha, \beta)\) such that \(V_T(\alpha, \beta) = H\). This means \(\beta+\alpha S_T(\omega) = H(\omega)\) for any \(\omega \in \set{\omega_1, \omega_2}\). Hence, we get a system of linear equations.

\begin{align*}
    \beta + 150\alpha &= 20\\
    \beta + 90 \alpha &= -0.
\end{align*}
Solving this for \(\alpha, \beta\) yields \(\alpha=1/3\) and \(\beta=-30\). Hence \[
    V_0(\alpha, \beta) = -30 + 100/3 = 10/3 = \pi(H).
\]
The hedging strategy that we get is to borrow \(30\) today and buy \(1/3\) stocks. The overall investment is \(10/3\). Two scenarios can happen at \(t=T\):
\begin{enumerate}
    \item \(S_T=150\). Selling the stock yields \(1/3 \cdot 150 = 50\). We repay our debt of \(30\) and yield \(20\) as profit.
    \item \(S_T=90\). Selling the stock yields \(1/3 \cdot 90 = 30\). We repay the debt and nothing happens.
\end{enumerate}
As we see, we hedged \(H\) perfectly. Now assume that we \underline{sell} the call option at a price of \(10/3\) and invest. Then, the following can happen.

\begin{enumerate}
    \item \(S_T=150\). The buyer will exercise the call, he or she will buy the stock for \(130\) from us,
    \item we have to buy the stock for \(150\), we lose \(20\),
    \item but we obtain \(20\) as by hedging in (1).
\end{enumerate}

\begin{enumerate}
    \item \(S_T=90\). Goes analogously.
\end{enumerate}

Using the no--arbitrage--principle, the fair price of the option is \(\pi(H)=10/3\). For any other price, a riskless profit would be possible. Assume \(\pi(H) > 10/3\). Then we get the following table:

\begin{table}[h!]
    \centering
        \begin{tabular}{ll}
            \toprule
            \textbf{Action at \(t=0\)} & \textbf{Payoff at \(t=T\)} \\
            \midrule
            Sell \(\pi(H)\) & \(-(S_T-K)^+\)\\
            Borrow \(30\) RA & \(-30\)\\
            Buy \(S_0/3\) & \(S_T/3\)\\
            Profit: \(\pi(H)+30-S_0/3=\pi(H)-10/3>0\) & \(\Sigma=0\) \\
            \bottomrule
        \end{tabular}
    \caption{Unfair pricing shows the possibility of riskless profit.}
\end{table}

Assume now \(\pi(H) < 10/3\). The table goes analogous to the above.

\begin{remark}
    Notice that the fair price \(\pi(H)\) in this example is \textbf{independent} of the subjective probability \(p\)! In more sophisticated models, we will also adapt to this.
\end{remark}

\subsection{Market assumptions}

In this section, we used a perfect market model.
\begin{itemize}
    \item The markets are frictionless, i.e.\ there are no taxes on profits and no transaction costs for reallocating portfolios,
    \item short--selling is allowed at all times and arbitrary shares can be bought and sold,
    \item interest rates for borrowing and lending are te same as well as investments in RA,
    \item there are no dividend payments,
    \item all market participants are rational and maximise their utility.
\end{itemize}

In a perfect market there is no arbitrage. Supply and demand offset each other perfectly and there are unique prices.

\section{Financial markets and the finite state space}

Our goal here is to introduce general financial markets. Finite means that there is a finite number of market states and a finite number of trading times \(\set{0, \dots, T}\). We describe trading strategies, arbitrage strategies and options formally.

\subsection{Definition of the financial market}

We take \((\Omega, \cF, (\cF_t)_{t}, \P)\) to be a filtered probability space. I.e.\
\begin{itemize}
    \item \(\Omega\) is a finite state space of elementary events,
    \item \(\cF\) is the power set of \(\Omega\) and acts as the \(\sigma\)-algebra,
    \item \((\cF_t)_t\) is a filtration,
    \item \(\P: \cF \to [0, 1]\) is a probability measure.
\end{itemize}

\begin{remark}
    We remark that for a probability space \((\Omega, \cF, \P)\) and an \underline{ordered} index set \(I\), a family of \(\cF\)-sub-\(\sigma\)-algebras \((\cF_i)_{i \in I}\) is a filtration if and only if for any \(t, s \in I: t \leq s \implies \cF_t \subseteq \cF_s\). Since our index sets \(I\) are always finite with maximal element \(T\), we make the additional presumption that \(\cF = \cF_T\).
\end{remark}

A \textbf{financial market} consists of \(d+1\) investment opportunities: one \textbf{riskless asset} with a deterministic price process \((B_t) = (B_0, \dots, B_T)\), i.e.\ imagine a savings account such that \(B_0 = 1\) and \(B_{t+1} \geq B_t\) for \(t = 1, \dots, T\). \(B_t\) is the value at the time \(t\) of \(1\) such unit that has been invested at \(t=0\), e.g.\ \(B_t = (1+r)^t\) for interest rate \(r \geq 0\).

A \textbf{risky asset} with stochastic processes \((S_t^k) = (S_0^k, \dots, S_T^k)\) and \(S_t^k(\omega) > 0\) for \(k = 1, \dots, d\) and \(t = 0, \dots, T\) and all \(\omega \in \Omega\). We define for \(t=0, 1, \dots, T\) \(S_t\) as \[
    S_t \defn (S_t^1, \dots, S^d_t).
\]
For example, imagine these to be \emph{stock prices} -- \(S_t^k\) is the price of stock \(k\) at time \(t\). The processes \((S_t^k)\) are assumed to be adapted \((k=1, \dots, d)\) to the filtration given, i.e.\ \((\cF_t)\). Hence \[
    \cF_t^S \subset \cF_t, \quad\text{where}\quad \cF_t^S = \sigma(S_0, \dots, S_t)
\]
is the \(\sigma\)-algebra generated by \((S_t)\) up to \(t\).

\begin{remark}[Repetition]
    \(\cF_t^X \defn \sigma(\set{X_s \mid s \leq t})\) for all \(t \in I\) is the \(\sigma\)-algebra generated by the stochastic process \(X\) itself.
\end{remark}

We can invest in the assets above and trade them, for this we define a trading strategy.

\begin{definition}[Trading Strategy]
    A trading strategy (a portfolio) is a \(\R^{d+1}\)-valued, \((\cF_t)\)-adapted stochastic process \(\phi = (\phi_0, \dots, \phi_{T-1})\), i.e. \(\phi_t\) is \(\cF_t\)-measurable and \(\phi_t = (\alpha_t, \beta_t)\) for \(t=0, \dots, T-1\).
\end{definition}
\begin{remark}
    In practice:
    \begin{itemize}
        \item \(\beta_t\) is the quantity of the riskless asset that is held in time period \([t, t+1)\) and
        \item \(\alpha_t = (\alpha_t^1, \dots, \alpha_t^d)\) where \(\alpha_t^k\) is the quantity of the risky asset \(k\) that is held in \([t, t+1)\),
        \item we denote \(\beta = (\beta_0, \dots, \beta_{T-1})\) and \(\alpha = (\alpha_0, \dots, \alpha_{T-1})\).
    \end{itemize}
\end{remark}
\begin{remark}[Repetition]
    A real-valued stochastic process is a mapping \(X: I \times \Omega \to \R\) such that \(X(t, \cdot): \Omega \to \R\) is measurable for every \(t \in I\), i.e.\ a sequence of real-valued random variables. For \(\omega \in \Omega\) fixed, \(t \mapsto X_t(\omega)\) is a called a \emph{path} of \(X\).
\end{remark}

\textbf{Adapted trading strategy.} If a trading strategy \(\phi\) is adapted, it means that \(\beta_t = \beta_t(S_0, \dots, S_t)\) and \(\alpha_t^k = \alpha_t^k(S_0, \dots, S_t)\) are functions of the prices \(S_0, \dots, S_t\). Investors thus observe prices up to time \(t\) and choose -- based on this information -- a new composition of \(\phi_t\) of the portfolio at time \(t\) which is then held until \(t+1\).

The information about the price processes is included in the filtration \((\cF_t^S) \subset (\cF_t)\).

We call the value of a trading strategy also a \emph{wealth process}.

\begin{definition}[Wealth process]
    The value of a trading strategy \(\phi\) at times \(t=0, \dots, T-1\) is given by \[
        V_t^\phi = \beta_t B_t + \alpha_t \cdot S_t = \beta_t B_t + \sum_{k=1}^d \alpha_t^k S_t^k.
    \]
    Moreover, we let \(V_T^\phi = \beta_{T-1} B_T + \alpha_{T-1} S_T\).
\end{definition}
\begin{remark}
    \(\beta_t B_t + \alpha_t \cdot S_t\) is the value of the trading strategy immediately after it has been recomposed. Change in the market values due to price changes are then \[
        \beta_{t-1} (B_t - B_{t-1}) + \alpha_{t-1} \cdot (S_t-S_{t-1}).
    \]
\end{remark}

\begin{definition}[Self-financing]
    A trading strategy is called self-financing if for \(t=1, \dots, T-1\)
    \begin{equation}\label{eq:selfFinancing}
        \beta_{t-1} B_t + \alpha_{t-1} \cdot S_t = \beta_t B_t + \alpha_t \cdot S_t.
    \end{equation}
\end{definition}

\begin{remark}[Explanation]
    When the investor observes the new prices \(B_t, S_t\), she adjusts the trading strategy from \(\phi_{t-1}\) to \(\phi_t\) without adding or assuming additional wealth. Thus, \eqref{eq:selfFinancing} must hold.
\end{remark}

\emph{We show:} For a self-financing trading strategy \(\phi = (\alpha, \beta)\), this is equivalent to knowing \((V_0^\phi, \alpha)\) and hence \(\beta\) can be determined from \eqref{eq:selfFinancing}.

Denote the set of trading strategies of risky assets as \[
    \cA \defn \set{\alpha = (\alpha_0, \dots, \alpha_{T-1}) : \alpha_t \text{ is } \cF_t\text{--measurable for } t=0, \dots, T-1}
\]

Hence if the initial wealth \(V_0^\phi\) is known, every \(\alpha \in \cA\) can be complemented in a self-financing way.

\begin{remark}[Notation]
    \(\Delta X_t = X_t - X_{t-1}\), \(\Delta \alpha_t = (\Delta \alpha_t^1, \dots, \Delta \alpha_t^d)\).
\end{remark}

\begin{lemma}\label{le:SELFF_TO_BETA}
    Let \(\phi\) be self-financing. Then we have \[
        \beta_t = \beta_0 - \sum_{k=1}^t \Delta \alpha_n \frac{S_n}{B_n} = V_0^\phi - \sum_{k=0}^t \Delta \alpha_n \frac{S_n}{B_n},
    \]
    for \(t=0, \dots, T-1\) where \(\Delta \alpha_0^k \defn \alpha_0^k\) for \(k=1, \dots, d\).
\end{lemma}
\begin{proof}
    Let \(t=0\), then \(V_0^\phi = \beta_0 B_0 + \alpha_0 \cdot S_0 = \beta_0 + \alpha_0 \cdot S_0\) by normalising \(B_0 = 1\). Hence \[
        \beta_0 = V_0^\phi - \alpha_0 \frac{S_0}{B_0} = V_0^\phi - \Delta \alpha_0 \frac{S_0}{B_0}.
    \]
    Let \(t \in \set{1, \dots, T-1}\), then, since \((\alpha, \beta)\) is self-financing, we get \[
        \beta_t B_t + \alpha_t \cdot S_t = \beta_{t-1} B_t + \alpha_{t-1} \cdot S_t \iff (\beta_t-\beta_{t-1}) B_t = -(\alpha_t - \alpha_{t-1}) \cdot S_t
    \]
    and hence \(\Delta \beta_t = - \Delta \alpha_t \frac{S_t}{B_t}\).
    This implies \[
        \beta_t = \beta_0 + \sum_{n=1}^t \Delta \beta_n = \beta_0 - \sum_{n=1}^t \Delta \alpha_n \frac{S_n}{B_n} = V_0^\phi - \Delta \alpha_0 \frac{S_0}{B_0} - \sum_{n=1}^t \Delta \alpha_n \frac{S_n}{B_n}.\qedhere
    \]
\end{proof}

\begin{definition}[Discounted stock price]
    \(\tilde{S}_t^k \defn \frac{S_t^k}{B_t}\) is the discounted stock price of risky asset \(k\) at \(t\).
\end{definition}

\begin{lemma}
    Let \(\phi\) be self-financing. Then we have \[
        \frac{V_t^\phi}{B_t} = V_0^\phi + \sum_{n=1}^t \alpha_{n-1} \Delta \tilde{S}_n.
    \]
\end{lemma}
\begin{proof}
    As \(\phi\) is self-financing, we have
    \begin{align*}
        \frac{V_n^\phi}{B_n} - \frac{V_{n-1}^\phi}{B_{n-1}}
        &= \frac{1}{B_n}\left( \beta_n B_n + \alpha_n \cdot S_n \right) - \frac{1}{B_{n-1}}\left( \beta_{n-1} B_{n-1} + \alpha_{n-1} \cdot S_{n-1} \right)\\
        &\stackrel{\text{SF}}{=} \frac{1}{B_n} \left( \beta_{n-1} B_n + \alpha_{n-1} S_n \right) - \frac{1}{B_{n-1}} \left( \beta_{n-1} B_{n-1} + \alpha_{n-1} \cdot S_{n-1} \right)\\
        &= \underbrace{\beta_{n-1}-\beta_{n-1}}_{=0} + \alpha_{n-1} \left( \frac{S_n}{B_n} - \frac{S_{n-1}}{B_{n-1}} \right)\\
        &= \alpha_{n-1} \Delta \tilde{S}_n.
    \end{align*}
    We have that with \(B_0 = 1\): \[
        \frac{V_t^\phi}{B_t} = \frac{V_0^\phi}{B_0} + \sum_{n=1}^t \left( \frac{V_n^\phi}{B_n} - \frac{V_{n-1}^\phi}{B_{n-1}} \right) = V_0^\phi + \sum_{n=1}^t \alpha_{n-1} \Delta \tilde{S}_n.\qedhere
    \]
\end{proof}

\begin{definition}[Gains Process]
    For a trading strategy \(\alpha \in \cA\), the process \((G_t^\alpha)\), defined by \[
        G_0^\alpha = 0 \quad \text{and} \quad G_t^\alpha = \sum_{n=1}^t \alpha_{n-1}  \cdot \Delta \tilde{S}_n, \quad t=1, \dots, T
    \]
    is called the \textbf{gains process}.
\end{definition}

\textbf{No-arbitrage-principle.}

\begin{definition}[Arbitrage Strategy]
    Let \(\phi\) be self-financing. \(\phi\) is called arbitrage strategy if \[
        V_0^\phi = 0, \quad \P(V_T^\phi \geq 0) = 1 \quad \text{and}\quad \P(V_T^\phi > 0) > 0.
    \]
\end{definition}
\begin{remark}
    We say that there is an arbitrage opportunity if such an arbitrage strategy exists. (NA) means that there is no arbitrage opportunity.

    Recall that \(\P(\set{\omega}) > 0\) for any \(\omega \in \Omega\) by definition of our financial market. Thus \[
        \P(V_T^\phi \geq 0) = 1 \iff V_T^\phi(\omega) \geq 0 \quad \text{for any} \quad \omega \in \Omega.
    \]
    Moreover, \[
        \P(V_T^\phi > 0) > 0 \iff \exists \omega \in \Omega: V_T^\phi(\omega) > 0.
    \]
\end{remark}

We know from before that \[
    \frac{V_T^\phi}{B_T} = V_0^\phi + G_T^\alpha, \quad \phi = (\alpha, \beta)
\]
where \(\phi\) is self-financing. Now, an arbitrage strategy exists if and only if there exists a trading strategy \(\phi\) with \(V_0^\phi = 0\) and \(\P(G_T^\alpha \geq 0) = 1\) and \(\P(G_T^\alpha > 0) > 0\).

In words, the next theorem tells us that a financial market is globally free of arbitrage if and only if it is locally free of arbitrage.

\begin{theorem}\label{th:ARB_STRAT_EQUIV}
    The following are equivalent.
    \begin{itemize}
        \item There exists an arbitrage strategy.
        \item There exists a \(t \in \set{1, \dots, T}\) and a \(\cF_{t-1}\)-measurable random vector \(\eta: \Omega \to \R^{d}\) such that \(\P(\eta \cdot (\tilde{S}_t - \tilde{S}_{t-1}) \geq 0) = 1\) and \(\P(\eta \cdot (\tilde{S}_t - \tilde{S}_{t-1}) > 0) > 0\). Here, \(\eta\) depends on \(t\).
    \end{itemize}
\end{theorem}
\begin{proof}
    Let \(\phi = (\alpha, \beta)\) be an arbitrage strategy with wealth process \((V_t^\phi)\) and let \[
        t = \min\set{m \in \N \mid \P(V_m^\phi \geq 0) = 1 \text{ and } \P(V_m^\phi > 0) > 0}.
    \]
    Then \(t \leq T\) and \underline{either} (a) \(\P(V_{t+1}^\phi = 0) = 1\) \underline{or} (b) \(\P(V_{t-1}^\phi < 0) > 0\). In case of (a), we have \[
        \alpha_{t-1} \cdot (\tilde{S}_t - \tilde{S}_{t-1}) = \frac{V_T^\phi}{B_t} - \frac{V_{t-1}^\phi}{B_{t-1}} = \frac{V_t^\phi}{B_t} \geq 0.
    \]
    Using \(\eta = \alpha_{t-1}\) we obtain \(\P(\eta \cdot (\tilde{S}_t - \tilde{S}_{t-1}) > 0) > 0\) for some development of \(S_t\) and moreover \(\P(\eta \cdot (\tilde{S}_n - \tilde{S}_{n-1}) \geq 0) = 1\). In case (b) we get by \[
        \eta = \alpha_{t-1} \indic[V_{t-1}^\phi < 0]
    \]
    that \[
        \eta \cdot (\tilde{S}_t - \tilde{S}_{t-1}) = \left(\frac{V_t^\phi}{B_t} - \frac{V_{t-1}^\phi}{B_{t-1}}\right) \cdot \indic[V_{t-1}^\phi < 0] \geq \frac{V_t^\phi}{B_t} \indic[V_{t-1}^\phi < 0]
    \]
    and hence \(\P(\eta \cdot (\tilde{S}_t - \tilde{S}_{t-1}) \geq 0) = 1\) and \(\P(\eta \cdot (\tilde{S}_t - \tilde{S}_{t-1}) > 0) > 0\).

    Now the backward direction. Define a trading strategy \(\phi = (\alpha, \beta)\) by \[
        \alpha_m = \begin{cases}
            \eta, &m=t-1\\
            0, &\text{else}.
        \end{cases}
    \]
    \(\alpha\) can be completed to a self-financing trading strategy  with \(V_0^\phi = 0\). By the previous lemmas, \[
        \frac{V_T^\phi}{B_T} = V_0^\phi + \sum_{n=1}^t \alpha_{n-1}\Delta \tilde{S}_n = \eta \cdot (\tilde{S}_n - \tilde{S}_{n-1}).
    \]
    Moreover, using the assertion we get \(\P(\eta \cdot (\tilde{S}_t - \tilde{S}_{t-1}) \geq 0) = 1 = \P(V_T^\phi/B_T \geq 0)\) and \(\P(\eta \cdot (\tilde{S}_t - \tilde{S}_{t-1}) > 0) = \P(V_T^\phi/B_T > 0) > 0\).
\end{proof}

\begin{example}
    We assume a financial market with \(T=2\) periods and a RA with \(B_0 = B_1 = B_2 = 1\). We assume the following price behaviour.
    \begin{figure}[h!]
        \begin{center}
            \begin{forest}
                for tree={
                    grow=east,
                    draw,
                    edge={-latex},
                    anchor=west,
                    s sep=20pt,
                    l sep=30pt,
                    align=center,
                    font=\small,
                }
                [{$S_0 = 4$}
                    [{$S_1(u_1)=6$}
                        [{$S_2(u_1,u_2)=8$}]
                        [{$S_2(u_1,d_2)=5$}]
                    ]
                    [{$S_1(d_1)=3$}
                        [{$S_2(d_1,u_2)=4$}]
                        [{$S_2(d_1,d_2)=2$}]
                    ]
                ]
            \end{forest}
        \end{center}
        \caption{Price behaviour in our \(2\)-period market.}
        \label{fig:example_2_period_market_dt}
    \end{figure}\\
    We let \(\Omega = \set{u_1, d_1} \times \set{u_2, d_2}\). We now want to check whether our whole financial market is free of arbitrage by using the previous theorem. We start with \(t=1\) and obtain \[
        \eta\left( \tS_n(y_1) - S_0 \right) = \begin{cases}
            \eta(6-4)=2\eta, &y_1=u_1\\ \eta(3-4)=-\eta, &y_1=d_1.
        \end{cases}
    \]
    As the cases have different signs, we cannot choose any common \(\eta \neq 0\) such that \(\eta(\tS_1(y_1)-S_0) \geq 0\) for all \(y_1\) and hence (NA) holds in period \(t=1\). For \(t=2\), need to check two cases. Indeed, \[
        \eta(u_1) \left(\tS_2(u_1, y_2)-\tS_1(u_1)\right) = \begin{cases}
            \eta(u_1) (8-6) = 2 \eta(u_1), &y_2=u_2\\
            \eta(u_1)(5-6)=-\eta(u_1), &y_2=d_2.
        \end{cases}
    \]
    By the same logic as before, with differing signs, we have (NA). Moreover,
    \[
        \eta(d_1)\left(\tS_1(d_1,y_2)-\tS_1(d_1)\right) = \begin{cases}
            \eta(d_1)(4-3)=\eta(d_1),&y_2=u_2\\ \eta(d_1)(2-3)=-\eta(d_1),&y_2=d_2
        \end{cases}
    \]
    yields differing signs again. Now we have checked all branches of the decision tree and get that (NA) holds for the whole financial market by \Cref{th:ARB_STRAT_EQUIV}.
\end{example}

\subsection{Options}

Options are characterised by the payoff. For \emph{european options}, the payoff happens at exercise date \(T\).

\begin{definition}[Contingent Claim]
    A contingent claim is an \(\cF_T\)-measurable random variable \(H\) with values in \(\R\).
\end{definition}
\begin{remark}
    If \(H \in \cF_T^S\), then \(H = h(S_0, \dots, S_T)\).
\end{remark}

\begin{example}[Examples of Contingent Claims]
    \textbf{European call options} with strike price \(K\): \[
        H = (S_T-K)^+
    \]
    is only exercised when \(S_T > K\).
    \textbf{European put options} with strike \(K\): \[
        H = (K-S_T)^+
    \]
    is only exercised when \(S_T < K\). A \textbf{Future} is delivered with certainty, thus \[
        H = S_T-K.
    \]
    Here, \(K\) is a fixed reference price and \(T\) the delivery date.
    A \textbf{digital call option} with strike \(K\):
    \[
        H = \indic[S_T>K]
    \]
    yields payoff of \(1\) unit if \(S_T>K\). A \textbf{down-and-out-call} with strike \(K\) and barrier \(B\):\[
        H = (S_T-K)^+ \indic[\min_{t \in \set{0, \dots, T}} S_t > B]
    \]
    depends on the whole path of \(S\). These are cheaper than classical options. \textbf{Asian call options} are characterised by \[
        H = \left( S_T-\frac{1}{T}\sum_{t=1}^T S_t \right)^+
    \]
    is only exercised when the stock price is greater than the arithmetic mean. Also these are obviously path-dependent.
\end{example}

\begin{definition}[Attainability and completeness]
    \begin{enumerate}[label=(\alph*)]
        \item A contingent claim \(H\) is attainable if there is a trading strategy \(\phi\) with \(V_T^\phi = H\). Then \(\pi(H) = V_0^\phi\) is called a price of \(H\) and \(\phi\) is called duplication/replication/hedging strategy of \(H\).
        \item We say a market is complete if any contingent claim is attainable.
    \end{enumerate}
\end{definition}

With this definition we get the following lemma.

\begin{lemma}[Price of attainable claims]
    Suppose absence of arbitrage (NA). Then, the price \(\pi(H)\) for an attainable contingent claim \(H\) is unique and thus independent of the choice of hedging strategy.
\end{lemma}
\begin{proof}
    Let \(H\) be an attainable contingent claim. Let \(\phi = (\alpha, \beta)\) and \(\tilde{\phi} = (\tilde{\alpha}, \tilde{\beta})\) be hedging strategies for \(H\). By \Cref{le:SELFF_TO_BETA}, \(\phi, \tilde{\phi}\) can be expressed via \((V_0^\phi, \alpha), (V_0^{\tilde{\phi}}, \tilde{\alpha})\) and by lemma 2.2, \[
        V_0^\phi + G_T^\alpha = \frac{H}{B_T} = V_0^{\tilde{\phi}} + G_T^{\tilde{\alpha}}
    \]
    and \(H = V_T^\phi = V_T^{\tilde{\phi}}\) as \(\phi\) and \(\tilde{\phi}\) are hedging strategies. Assume \(d = V_0^{\tilde{\phi}} - V_0^\phi > 0\). Then
    \begin{align*}
        0
        &= V_0^\phi - V_0^{\tilde{\phi}} - G_T^{\tilde{\alpha}} + G_T^\alpha\\
        &= -d - G_T^{\tilde{\alpha}} + G_T^{\alpha}\\
        &= -d + \sum_{n=1}^T \left( \alpha_{n-1} - \tilde{\alpha}_{n-1} \right) \cdot \Delta \tilde{S}_{n}\\
        &= -d + G_T^{\alpha-\tilde \alpha} \implies G_T^{\alpha - \tilde \alpha} = d > 0.
    \end{align*}
    Now, \(\psi\) is an arbitrage strategy, where \(\psi \defn (\hat{\alpha}, \hat{\beta})\) where \(\hat{\alpha} \defn \alpha - \tilde{\alpha}\) and \(\hat{\beta}\) is determined by \Cref{le:SELFF_TO_BETA} with \(V_0^\phi = 0\). This is a contradiction to (NA).
\end{proof}

\begin{example}
    We use the tree-based model from the last example. Recall the structure:
    \begin{figure}[h!]
        \begin{center}
            \begin{forest}
                for tree={
                    grow=east,
                    draw,
                    edge={-latex},
                    anchor=west,
                    s sep=20pt,
                    l sep=30pt,
                    align=center,
                    font=\small,
                }
                [{$S_0 = 4$}
                    [{$S_1(u_1)=6$}
                        [{$S_2(u_1,u_2)=8$}]
                        [{$S_2(u_1,d_2)=5$}]
                    ]
                    [{$S_1(d_1)=3$}
                        [{$S_2(d_1,u_2)=4$}]
                        [{$S_2(d_1,d_2)=2$}]
                    ]
                ]
            \end{forest}
        \end{center}
        \caption{Price behaviour in our \(2\)-period market.}
    \end{figure}
    Consider the digital call with \(H = \indic[S_2 \geq 5]\). This will only pay \(1\) if \(S_2 \geq 5\). We get 
    \begin{align*}
        H(u_1, u_2) &= H(u_1, d_2) = 1\\
        H(d_1, u_2) &= H(d_1, d_2) = 0.
    \end{align*}
    How can we construct a hedging strategy here? We must find \(\phi\) with \(V_T^\phi = H\). For \(t=2\) and the upper node, we get \begin{align*}
        H(u_1,u_2)&=1=8\alpha_1(u_1)+\beta_1(u_1)=V_2^\phi(u_1,u_2)\\
        H(u_1,d_2)&=1=5\alpha_1(u_1)+\beta_1(u_1)=V_2^\phi(u_1,d_2).
    \end{align*}
    Solving yields \(alpha_1(u_1)=0\) and \(\beta_1(u_1)=1\). Hence \(V_1^\phi = 6\alpha_1(u_1)+\beta_1(u_1)=1\) by the self-financing property. For the lower node, observe
    \begin{align*}
        H(d_1, u_2) &= 0 = 4 \alpha_1(d_1)+\beta_1(d_1)=V_2^\phi(d_1,u_2)\\
        H(d_1, d_2) &= 0 = 2 \alpha_1(d_1)+\beta_1(d_1)=V_2^\phi(d_1,d_2).
    \end{align*}
    Solving yields \(\alpha_1(d_1)=0\) and \(\beta_1(d_1)=0\) and hence \(V_1^\phi = 3 \alpha_1(d_1)+\beta_1(d_1) = 0\) by self-financing.

    We can now look at \(t=1\). We have
    \begin{align*}
        V_1^\phi(u_1) &= 1 = 6\alpha_0+\beta_0\\
        V_1^\phi(d_1) &= 0 = 3\alpha_0+\beta_0,
    \end{align*}
    which yields \(\alpha_0=1/3\) and \(\beta_0=-1\) and hence \[
        \pi(H) = V_0^\phi = S_0\alpha_0 + \beta_0B_0 = 4 \alpha_0+\beta_0 = \frac{4}{3}-1=\frac{1}{3}.
    \]
\end{example}

\begin{remark}
    All considerations in this section are without accounting for transaction costs.
\end{remark}

\section{The Cox--Ross--Rubinstein model}

This is a simple model in discrete time. We assume \(1\) riskless asset and \(1\) risky asset.

\subsection{One-period CRR model}

We assume \(T=1\) and \(\Omega=\set{u, d}\) and \(\cF_T = \cF = 2^\Omega\). For the riskless asset, we set \(B_0=1\) and \(B_1 = 1+r,\, r \geq 0\). For the risky asset, we assume a random variable \(S_0 > 0\) and \[
    S_1(\omega) = \begin{cases}
        uS_0, &\omega=u\\
        dS_0, &\omega=d
    \end{cases}
\]
for functions \(0 < d < u\). We then call \(u\) \emph{up-factor} and \(d\) the \emph{down-factor}. The case \(u=d\) is not interesting since it reduces to a deterministic case.

The basic question we want to ask is: \emph{When is this model free of arbitrage?}

\begin{theorem}\label{th:CRR_NA}
    Consider the one-period CRR model. Then, the market is free of arbitrage if and only if \(d < 1 + r < u\).
\end{theorem}
\begin{proof}
    Let's assume \(d < 1+r < u\) or equivalently \(\frac{dS_0}{1+r} - S_0 < 0 < \frac{u S_0}{1+r} - S_0\). Hence, \(S_1(d)/(1+r)-S_0 < 0 < S_1(u)/(1+r)-S_0\). Now, \(\tilde{S} = S/B\) with \(B_1 = 1+r\). We get \(\tilde{S}_1(d) - S_0 < 0 < \tilde{S}_1(u) - S_0\) and by noting \(\tilde{S_0} = S_0\) and applying \Cref{th:ARB_STRAT_EQUIV}, we get that there exists an \(\omega\) and some \(\eta \neq 0\) such that \(\eta(\tilde{S_n}(\omega) - \tilde{S}_0) < 0\), which implies that there is no arbitrage.
\end{proof}

What can we say about completeness?

\begin{theorem}\label{th:CRR_COMPLETE}
    Suppose there is no arbitrage. Then the CRR model is complete. In particular, \[
        \alpha_0 = \frac{H(u) - H(d)}{(u-d)S_0}, \quad \beta_0 = \frac{uH(d) - dH(u)}{(u-d)(1+r)}.
    \]
    Then, \(\pi(H) = \frac{uH(d) - dH(u)}{(u-d)(1+r)} + \frac{H(u)-H(d)}{u-d}\) is the unique price.
\end{theorem}
\begin{proof}
    If \(\phi\) is a hedging strategy, then at \(T=1\), we have \[
        V_1^\phi = \beta_0(1+r) + \alpha_0 S_1 = H.
    \]
    Hence, \begin{align*}
        \beta_0(1+r) + \alpha_0 \underbrace{S_1(u)}_{uS_0} &= H(u)\\
        \beta_0 (1+r) + \alpha_0 \underbrace{S_1(d)}_{dS_0} &= H(d).
    \end{align*}
    Some calculating yields \(\alpha_0=\frac{H(u)-H(d)}{(u-d)S_0}\) and \(\beta_0=\frac{uH(d)-dH(u)}{(u-d)(1+r)}\). Obviously, \(\pi(H)=V_0^\phi=\beta_0B_0+\alpha_0S_0\).
\end{proof}

\begin{example}
    Let \(u=1.1\) and \(d=0.9\) and \(r=0.05\). Due to \Cref{th:CRR_NA}, the market is free of arbitrage. Let \(S_0 = 100\) and \(H(u)=80\) and \(H(d)=60\). The price due to \Cref{th:CRR_COMPLETE} is \[
        \pi(H) = \frac{1.1 \cdot 60 - 0.9 \cdot 80}{(1.1 - 0.9) 1.05} + \frac{80-60}{1.1-0.9} = 71.42.
    \]
    The corresponding hedging strategy is \[
        \alpha_0 = \frac{80-60}{0.2 \cdot 100} = 1
    \]
    and \[
        \beta_0 = -28.57.
    \]
\end{example}

\begin{remark}[Preparatory remark on Equivalent Martingale Measures (EMMs)]
    We can rearrange \(\pi(H)\) from before as \[
        \pi(H) = \frac{H(u)}{1+r} \cdot \frac{1+r-d}{u-d} + \frac{H(d)}{1+r} \left(1-\frac{1+r-d}{u-d}\right) =: \star.
    \]
    This can be seen from \begin{align*}
        \star
        &= \frac{H(u)}{1+r}\left(\frac{1+r}{u-d}-\frac{d}{u-d}\right) + \frac{H(d)}{1+r}\left(1-\frac{1+r}{u-d}+\frac{d}{u-d}\right)\\
        &= \frac{H(u)}{u-d} - \frac{dH(u)}{(1+r)(u-d)} + \frac{H(d)}{1+r} - \frac{H(d)}{u-d} + \frac{d H(d)}{(1+r)(u-d)}\\
        &= \frac{H(u)-H(d)}{u-d} + \frac{dH(d)-dH(u)}{(1+r)(u-d)}+\frac{H(d)}{1+r}\\
        &= \frac{H(u)-H(d)}{u-d} + \frac{dH(d)-dH(u)+uH(d)-dH(d)}{(1+r)(u-d)}\\
        &= \frac{H(u)-H(d)}{u-d} + \frac{uH(d)-dH(u)}{(1+r)(u-d)} = \pi(H).
    \end{align*}
    We fix \(q \defn \frac{1+r-d}{u-d}\) and hence \(0 < q < 1\) as by (NA) we know that \(d<1+r<u\) and thus \[
        \pi(H) = \frac{H(u)}{1+r}q+\frac{H(d)}{1+r}(1-q).
    \]
    Define the probability measure \(\Q\) on \((\Omega, \cF_T)\) as \[
        \Q(\set{u}) = q, \quad \Q(\set{d})=1-q.
    \]
    Hence, \(\pi(H) = \E_\Q \left[ \frac{H}{1+r} \right]\) where \(\E_\Q\) is the expectation w.r.t.\ \(\Q\).
    We obtain for the discounted price \(\tilde{S}_1 = \frac{S_1}{B_1}\) that
    \begin{align*}
        \E_\Q \tilde{S}_1
        &= S_0 \left( \frac{u}{1+r}q + \frac{d}{1+r}(1-q) \right)\\
        &= S_0 \left( q \left[ \frac{u}{1+r}-\frac{d}{1+r} \right] + \frac{d}{1+r} \right)\\
        &= S_0 \left( \frac{1+r-d}{u-d} \frac{u-d}{1+r} + \frac{d}{1+r} \right)\\
        &= S_0 \left( \frac{1+r-d+d}{1+r} \right) = \tilde{S}_0.
    \end{align*}
    Hence, discounted stock prices are martingales with respect to the risk-neutral measure. One can even show that the measure \(\Q\) is the only (i.e.\ unique) measure that satisfies the martingale property \(\E_\Q \tilde{S}_1 = \tilde{S}_0\).
\end{remark}

\subsection{Digression: Conditional Expectation and Martingales}
\(\Omega, \cF, \P\) is a probability space.
\begin{definition}[Conditional Expectation]
    Let \(X \in L^1(\Omega, \cF, \P)\) and \(\cG \subset \cF\). \(Z\) is the conditional expectation of \(X\) on conditioned on \(\cG\) if and only if \begin{itemize}
        \item \(Z\) is \((\cG, \cB)\)-measurable,
        \item \(\intt[A][][X][\P] = \intt[A][][Z][\P]\) for all \(A \in \cG\).
    \end{itemize}
    The conditional expectation of \(X\) given \(B \in \cF\) with \(\P(B) > 0\) is \[
        \E(X \mid B) = \frac{\E(X \cdot \indic_B)}{\P(B)} = \frac{1}{\P(B)} \intt[B][][X][\P].
    \]
\end{definition}

\begin{remark}
    Recall that \(\P(A \mid B) = \frac{\P(A \cap B)}{\P(B)},\, A, B \in \cF, \P(B) > 0\).
\end{remark}
Let \(\Omega\) be finite and \(\P(\set{\omega}) > 0\) for any \(\omega \in \Omega\). A sub-\(\sigma\)-algebra \(\cG\) of \(\cF\) can always be generated by a partition of \(\Omega\). That means there exist subsets \(A_1, \dots, A_n\) with \(A_i \cap A_j = \emptyset\) for any \(i, j \in \set{1, \dots, n}\) and \(\bigcup_{1 \leq i \leq n} A_i = \Omega\) and hence \[
    \cG = \sigma\left(\set{A_1, \dots, A_n}\right) = \set{\bigcup_{i \in T} A_i: T \subset \set{1, \dots, n}}.
\]
\begin{theorem}
    Let \(\Omega\) be finite and \(\cG = \sigma(\set{A_1, \dots, A_n})\) be a sub-\(\sigma\)-algebra of \(\cF\). The conditional expectation of \(X\) given \(\cG\) is the random variable \[
        \E(X \mid \cG)(\omega) = \sum_{i=1}^n \E(X \mid A_i) \cdot \indic_{A_i}(\omega), \quad \omega \in \Omega.
    \]
\end{theorem}
\begin{proof}
    Let \(Z\) be defined as above. Then \(Z\) is constant on the respective sets \(A_i\) and hence \(Z \in (\cG, \cB)\). For all \(j \in \set{1, \dots, n}\), we have
    \begin{align*}
        \intt[A_j][][\sum_{i=1}^n \E (X \mid A_i) \indic_{A_i}][\P]
        = \intt[A_j][][\E(X \mid A_j)][\P]
        = \intt[A_j][][\frac{\E(X \cdot \indic_{A_j})}{\P(A_j)}][\P] = \E(X \indic_{A_j}).
    \end{align*}
\end{proof}

\begin{lemma}[Some properties]
    Let \(X, Y \in L^1(\Omega, \cF, \P)\). Then
    \begin{itemize}
        \item \(\E(\E(X \mid \cG)) = \E(X)\),
        \item if \(X \in \cG\), then \(\E(X \mid \cG) = X\),
        \item \(\E(aX+bY \mid \cG) = a \E(X \mid \cG) + b \E(Y \mid \cG)\) for any \(a, b \in \R\),
        \item \(X \leq Y \implies \E(X \mid \cG) \leq \E(Y \mid \cG)\),
        \item conditional Jensen's inequality: \(f: \R \to \R\) integrable and convex, then \[
            \E(f(X) \mid \cG) \geq f(\E(X \mid \cG)),
        \]
        \item Tower property: if \(\cH \subseteq \cG\), then \[
            \E(\E(X \mid \cG) \mid \cH) = \E(\E(X \mid \cH) \mid \cG) = \E(X \mid \cH),
        \]
        \item measurable factorisation: for \(Y \in \cG\) we have \[
            \E (\abs[YX]) < \infty \implies \E(YX \mid \cG) = Y \E(X \mid \cG),
        \]
        \item \(X \perp \cG\) implies \(\E(X \mid \cG) = \E(X)\).
    \end{itemize}
\end{lemma}

A martingale is a stochastic process with special properties.

\begin{definition}[Stochastic Process]
    A sequence of random variables \(\left(X_t\right)_{t \in \N_0}\) with \(X_t: \Omega \to \R\) is called a stochastic process. A sequence \(\left(\cF_t\right)_{t \in \N_0}\) of sub-\(\sigma\)-algebras with \(\cF_t \subset \cF\) is called a filtration if for all \(s \leq t: \cF_s \subseteq \cF_t\) for any \(s, t \in \N_0\). A stochastic process is adapted w.r.t.\ the filtration if \(X_t\) is measurable w.r.t.\ \(\cF_t\) for every \(t \in \N_0\).
\end{definition}

With this we can define what a martingale is.

\begin{definition}[Martingale]
    Let \(\left(X_t\right)_{t \in \N_0}\) be an adapted stochastic process such that \(\E(\abs[X_t]) < \infty\) for any \(t \in \N_0\). The process is called martingale if and only if
    \begin{equation}\label{eq:martingale}
        \E(X_t \mid \cF_s) = X_s,\qquad s \leq t.
    \end{equation}
\end{definition}
\begin{remark}[Interpretation]
    The value of the process remains \underline{constant in expectation} at all times. This can be used to model a fair game.
    A \textbf{submartingale} is a stochastic process for which the expectation increases: \(\E(X_t \mid \cF_s) \geq X_s\)
    and a \textbf{supermartingale} has decreasing expectation: \(\E(X_t \mid \cF_s) \leq X_s\) for any \(s \leq t \in \N_0\).
\end{remark}

\begin{remark}[Equivalent characterisations]
    We see that for \(t \in \N_0\)
    \begin{itemize}
        \item \eqref{eq:martingale} \(\iff \E(X_{t+1} \mid \cF_t) = X_t\),
        \item \eqref{eq:martingale} \(\iff \E(X_{t+1} - X_t \mid \cF_t) = 0\),
        \item \(X \in \cF \implies X_t = \E(X \mid \cF_t)\) is \(\cF_t\)-martingale.
    \end{itemize}
\end{remark}

\begin{example}
    Let \(X_1, \dots\) be independent and integrable with \(0\) mean. Define \(S_0 = 0\) and \(S_n = \sum_{i=1}^n X_i\) and let \(\cF_t = \sigma(\set{X_1, \dots, X_n})\) with \(\cF_0 = \set{\Omega, \emptyset}\). We check that
    \begin{align*}
        \E (S_{t+1} \mid \cF_t)
        &= \E(S_t+X_{t+1} \mid \cF_t)\\
        &= \E(S_t \mid \cF_t) + \E(X_{t+1} \mid \cF_t)\\
        &= S_t + \E(X_{t+1} \mid \cF_t)\\
        &= S_t + \E (X_{t+1}) = S_t
    \end{align*}
    since \(X_{t+1} \perp \cF_t\).
\end{example}

\begin{lemma}
    Let \((X_t)_{t \in \N_0}\) be an \((\cF_t)_{t \in \N_0}\)-martingale and \(f: \R \to \R\) convex with \(\E(\abs[f(X)]) < \infty\) for any \(t \in \N_0\). Then \((f(X_t))_{t \in \N_0}\) is a submartingale.
\end{lemma}
\begin{proof} \(\E(f(X_t) \mid \cF_s) \geq f(\E(X_t \mid \cF_s)) = f(X_s)\).
\end{proof}

\begin{definition}[Previsibility]
    A stochastic process is called \emph{previsible} if \(X_t \in \cF_{t-1}\) for any \(t > 1\).
\end{definition}

\begin{theorem}[Doob decomposition]
    Let \((X_t)\) be a \((\cF_t)\)-supermartingale. Then \((X_t)\) can be written as \[
        X_t = M_t + A_t, \quad t \in \N_0
    \]
    where \(M_t\) is a \(\cF_t\)-martingale, \(A_t\) is decreasing and \(A_0=0\). Moreover, \((A_t)\) is previsible and the decomposition is unique \(\P\)-a.s.
\end{theorem}

\begin{remark}
    Recall the gains process \[
        G_t^\alpha = \sum_{n=1}^t \alpha_{n-1} \cdot \Delta \tilde{S}_n = \sum_{n=1}^t \alpha_{n-1} \cdot (\tilde{S_n}-\tilde{S}_{n-1})
    \]
    for \(t \in \set{1, \dots, T}\). Consider a gambling game in discrete time. We play at time \(t \in \N\) and \(\Delta Z_t = T_t - Z_{t-1}\) denotes the profit in time \(t\). If \((Z_t)\) is a martingale, the game is fair because \[
        \E(\Delta Z_t \mid \cF_{t-1}) = \E(Z_t - Z_{t-1} \mid \cF_{t-1}) = 0.
    \]
    If \((Z_t)\) is a supermartingale, i.e.\ \(\E(\Delta Z_t \mid \cF_{t-1}) \leq 0\) means the game is disadvantageous and \((Z_t)\) being a submartingale means that the game is advantageous.
\end{remark}

\textbf{Question.} Can we obtain a positive expected profit?
Let \((c_t)\) be \((\cF_t)\)-adapted and let \(c_{t-1}\) represent the stake in the \(t\)-th game. The player chooses \(c_{t-1}\) using the information available up to time \(t-1\). The profit of the \(t\)-th game is \[
    c_{t-1} \Delta Z_t = c_{t-1} (Z_t-Z_{t-1})
\]
and hence the total profit \[
    G_t = \sum_{n=1}^t c_{n-1} \Delta Z_t , \quad G_0=0.
\]
\((G_t)\) is then called \textbf{martingale transformation} of \((Z_t)\).

\begin{theorem}
    Let \((Z_t)\) and \((c_t)\) be \((\cF_t)\)-adapted stochastic processes such that\[
        G_t = \sum_{i=1}^n c_{n-1} \Delta Z_t, \quad G_0=0, t \in \N
    \]
    is integrable. Let \((Z_t)\) be a martingale. Then \((G_t)\) is also a martingale.
\end{theorem}
\begin{proof}
    By assumption, \((G_t)\) is integrable. \((G_t)\) is adapted since \((Z_t)\) and \((c_t)\) are adapted. The martingale property is verified by \[
        \E(G_t-G_{t-1} \mid \cF_{t-1}) = \E(c_{t-1}(Z_t-Z_{t-1}) \mid \cF_{t-1}) = c_{t-1} \E(Z_t-Z_{t-1}\mid \cF_{t-1}) = 0.
    \]
\end{proof}

\section{Absence of arbitrage and equivalent martingale measures}
\section{Completeness and equivalent martingale measures}
\section{Risk--neutral pricing of contingent claims}
\section{American options}
\section{Portfolio optimization}

\end{document}